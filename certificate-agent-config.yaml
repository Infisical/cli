infisical:
  address: "https://app.infisical.com/"

auth:
  type: "universal-auth"
  config:
    client-id: "./client-id"
    client-secret: "./client-secret"
    remove_client_secret_on_read: false

certificates:
  - profile-id: "550e8400-e29b-41d4-a716-446655440000"
    destination-path: "./certs/web-server"

    # Certificate parameters
    common-name: "api.mycompany.com"
    alt-names:
      - "www.api.mycompany.com"
      - "internal-api.mycompany.com"
    key-algorithm: "RSA_2048"
    signature-algorithm: "RSA-SHA256"
    key-usages:
      - "digital_signature"
      - "key_encipherment"
    extended-key-usages:
      - "server_auth"

    # Lifecycle configuration
    ttl: "30d"
    renew-before-expiry: "7d"
    monitoring-interval: "6h"
    max-retries: 3
    retry-interval: "1h"

    # Post-hooks for automation
    post-hooks:
      on-issuance:
        command: "systemctl reload nginx"
        timeout: 30
      on-renewal:
        command: "systemctl reload nginx"
        timeout: 30
      on-failure:
        command: "logger 'Certificate failed for api.mycompany.com'"
        timeout: 10

    file-config:
      file-permissions: "0600"
      directory-permissions: "0755"

sinks:
  - type: "file"
    config:
      path: "access-token"